

```{r get_coeff_df}

coeffs_df = results %>% 
  extract_coeffs_from_gar_model() %>% 
  rename_all(tolower) %>% 
  rename(quantile = tau) %>% 
  filter(!name == "Intercept") %>% 
  mutate(name = str_remove_all(name, "_xreg")) %>% 
  mutate(
    name = recode(
      name,
      Dom_Macro = "Dom. Macro",
      Dom_Fin = "Dom. Fin. Cond.",
      Ext_Macro = "Ext. Macro",
      Ext_Fin = "Ext. Fin. Cond.",
      Dom_Fin_Cycle = "Dom. Fin. Cycle"
    )
  ) %>%
  mutate(name = factor(
    name,
    levels = c(
      "Dom. Macro",
      "Dom. Fin. Cond.",
      "Dom. Fin. Cycle",
      "Ext. Macro",
      "Ext. Fin. Cond."
    )
  ))

```



```{r plot_1_12_dom_macro_fin_cycle}

coeffs_df %>% 
  filter(name %in% c("Dom. Macro", "Dom. Fin. Cycle")) %>% 
  filter(horizon %in% c(1,12)) %>% 
  ggplot(aes(x = quantile, y = coeff, fill = significant)) + 
  scale_fill_manual(values = c("Significant" = "lightblue",
                               "Non Significant" = "lightgrey")) + 
  geom_col(width = 0.5) + 
  geom_hline(yintercept = 0, linetype = "dashed") + 
  facet_grid(cols = vars(name), rows = vars(horizon),
             scales = "free_y") + 
  xlab("Quantile") + ylab(NULL)

```



```{r plot_coeffs, fig.height=8}

coeffs_df %>% 
  mutate(horizon = factor(horizon, levels = c(1,4,8,12))) %>% 
  ggplot(aes(x = quantile, y = coeff, fill = significant)) + 
  scale_fill_manual(values = c("Significant" = "lightblue",
                               "Non Significant" = "lightgrey")) + 
  geom_col(width = 0.5) + 
  geom_hline(yintercept = 0, linetype = "dashed") + 
  facet_grid(rows = vars(name), cols = vars(horizon),
             scales = "free") + 
  xlab("Quantile") + ylab(NULL)

```

